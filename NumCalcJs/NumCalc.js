const NumCalc_GR = (Math.sqrt(5) + 1) / 2
const NumCalc_EPSILON = 2 ** (-23);
const NumCalc_ROOT_EPSILON = Math.sqrt(NumCalc_EPSILON)



let NumCalc_Gaussian_Wi_xi_64 = [{"wi":0.0486909570091397,  "xi":-0.0243502926634244},{"wi":0.0486909570091397,  "xi":0.0243502926634244},{"wi":0.0485754674415034,  "xi":-0.0729931217877990},{"wi":0.0485754674415034,  "xi":0.0729931217877990},{"wi":0.0483447622348030,  "xi":-0.1214628192961206},{"wi":0.0483447622348030,  "xi":0.1214628192961206},{"wi":0.0479993885964583,  "xi":-0.1696444204239928},{"wi":0.0479993885964583,  "xi":0.1696444204239928},{"wi":0.0475401657148303,  "xi":-0.2174236437400071},{"wi":0.0475401657148303,  "xi":0.2174236437400071},{"wi":0.0469681828162100,  "xi":-0.2646871622087674},{"wi":0.0469681828162100,  "xi":0.2646871622087674},{"wi":0.0462847965813144,  "xi":-0.3113228719902110},{"wi":0.0462847965813144,  "xi":0.3113228719902110},{"wi":0.0454916279274181,  "xi":-0.3572201583376681},{"wi":0.0454916279274181,  "xi":0.3572201583376681},{"wi":0.0445905581637566,  "xi":-0.4022701579639916},{"wi":0.0445905581637566,  "xi":0.4022701579639916},{"wi":0.0435837245293235,  "xi":-0.4463660172534641},{"wi":0.0435837245293235,  "xi":0.4463660172534641},{"wi":0.0424735151236536,  "xi":-0.4894031457070530},{"wi":0.0424735151236536,  "xi":0.4894031457070530},{"wi":0.0412625632426235,  "xi":-0.5312794640198946},{"wi":0.0412625632426235,  "xi":0.5312794640198946},{"wi":0.0399537411327203,  "xi":-0.5718956462026340},{"wi":0.0399537411327203,  "xi":0.5718956462026340},{"wi":0.0385501531786156,  "xi":-0.6111553551723933},{"wi":0.0385501531786156,  "xi":0.6111553551723933},{"wi":0.0370551285402400,  "xi":-0.6489654712546573},{"wi":0.0370551285402400,  "xi":0.6489654712546573},{"wi":0.0354722132568824,  "xi":-0.6852363130542333},{"wi":0.0354722132568824,  "xi":0.6852363130542333},{"wi":0.0338051618371416,  "xi":-0.7198818501716109},{"wi":0.0338051618371416,  "xi":0.7198818501716109},{"wi":0.0320579283548516,  "xi":-0.7528199072605319},{"wi":0.0320579283548516,  "xi":0.7528199072605319},{"wi":0.0302346570724025,  "xi":-0.7839723589433414},{"wi":0.0302346570724025,  "xi":0.7839723589433414},{"wi":0.0283396726142595,  "xi":-0.8132653151227975},{"wi":0.0283396726142595,  "xi":0.8132653151227975},{"wi":0.0263774697150547,  "xi":-0.8406292962525803},{"wi":0.0263774697150547,  "xi":0.8406292962525803},{"wi":0.0243527025687109,  "xi":-0.8659993981540928},{"wi":0.0243527025687109,  "xi":0.8659993981540928},{"wi":0.0222701738083833,  "xi":-0.8893154459951141},{"wi":0.0222701738083833,  "xi":0.8893154459951141},{"wi":0.0201348231535302,  "xi":-0.9105221370785028},{"wi":0.0201348231535302,  "xi":0.9105221370785028},{"wi":0.0179517157756973,  "xi":-0.9295691721319396},{"wi":0.0179517157756973,  "xi":0.9295691721319396},{"wi":0.0157260304760247,  "xi":-0.9464113748584028},{"wi":0.0157260304760247,  "xi":0.9464113748584028},{"wi":0.0134630478967186,  "xi":-0.9610087996520538},{"wi":0.0134630478967186,  "xi":0.9610087996520538},{"wi":0.0111681394601311,  "xi":-0.9733268277899110},{"wi":0.0111681394601311,  "xi":0.9733268277899110},{"wi":0.0088467598263639,  "xi":-0.9833362538846260},{"wi":0.0088467598263639,  "xi":0.9833362538846260},{"wi":0.0065044579689784,  "xi":-0.9910133714767443},{"wi":0.0065044579689784,  "xi":0.9910133714767443},{"wi":0.0041470332605625,  "xi":-0.9963401167719553},{"wi":0.0041470332605625,  "xi":0.9963401167719553},{"wi":0.0017832807216964,  "xi":-0.9993050417357722},{"wi":0.0017832807216964,  "xi":0.9993050417357722}]
let NumCalc_Gaussian_Wi_xi_300 = [{'wi': 8.217779367852784e-05, 'xi': -0.9999679782184367}, {'wi': 0.00019128554465451525, 'xi': -0.9998312829844194}, {'wi': 0.0003005339654054824, 'xi': -0.9995853734488864}, {'wi': 0.0004097635734026843, 'xi': -0.9992302218632736}, {'wi': 0.0005189512134561268, 'xi': -0.998765860353095}, {'wi': 0.0006280829779749172, 'xi': -0.9981923380734435}, {'wi': 0.0007371464159049647, 'xi': -0.9975097171758793}, {'wi': 0.0008461294290767029, 'xi': -0.9967180720510002}, {'wi': 0.0009550200344351948, 'xi': -0.9958174891208242}, {'wi': 0.0010638062980444988, 'xi': -0.9948080667630034}, {'wi': 0.0011724763137037884, 'xi': -0.9936899152742682}, {'wi': 0.0012810181954302762, 'xi': -0.9924631568471006}, {'wi': 0.0013894200749902227, 'xi': -0.9911279255509899}, {'wi': 0.0014976701014651013, 'xi': -0.9896843673150097}, {'wi': 0.0016057564416436195, 'xi': -0.9881326399103605}, {'wi': 0.001713667280856934, 'xi': -0.9864729129322606}, {'wi': 0.0018213908240185465, 'xi': -0.9847053677808957}, {'wi': 0.0019289152967671226, 'xi': -0.9828301976412724}, {'wi': 0.0020362289466651345, 'xi': -0.9808476074619004}, {'wi': 0.002143320044422011, 'xi': -0.9787578139322586}, {'wi': 0.0022501768851388364, 'xi': -0.9765610454590226}, {'wi': 0.0023567877895827394, 'xi': -0.9742575421410374}, {'wi': 0.002463141105431511, 'xi': -0.9718475557430343}, {'wi': 0.002569225208541661, 'xi': -0.9693313496680812}, {'wi': 0.0026750285042124664, 'xi': -0.9667091989287728}, {'wi': 0.0027805394284531617, 'xi': -0.9639813901171552}, {'wi': 0.0028857464492318416, 'xi': -0.9611482213733913}, {'wi': 0.0029906380677446804, 'xi': -0.9582100023531646}, {'wi': 0.0030952028196665126, 'xi': -0.9551670541938289}, {'wi': 0.0031994292764025785, 'xi': -0.952019709479303}, {'wi': 0.0033033060463318717, 'xi': -0.9487683122037179}, {'wi': 0.0034068217760577103, 'xi': -0.9454132177338137}, {'wi': 0.0035099651516519244, 'xi': -0.9419547927700982}, {'wi': 0.003612724899876582, 'xi': -0.9383934153067655}, {'wi': 0.0037150897894308427, 'xi': -0.93472947459038}, {'wi': 0.0038170486321701296, 'xi': -0.9309633710773335}, {'wi': 0.003918590284326866, 'xi': -0.927095516390074}, {'wi': 0.004019703647735912, 'xi': -0.9231263332721162}, {'wi': 0.004120377671042705, 'xi': -0.9190562555418367}, {'wi': 0.004220601350909151, 'xi': -0.9148857280450583}, {'wi': 0.00432036373322198, 'xi': -0.9106152066064295}, {'wi': 0.004419653914284973, 'xi': -0.9062451579796031}, {'wi': 0.0045184610420126335, 'xi': -0.9017760597962232}, {'wi': 0.0046167743171150275, 'xi': -0.8972084005137191}, {'wi': 0.00471458299427761, 'xi': -0.8925426793619202}, {'wi': 0.004811876383340633, 'xi': -0.88777940628849}, {'wi': 0.004908643850461776, 'xi': -0.8829191019031915}, {'wi': 0.005004874819279619, 'xi': -0.8779622974209857}, {'wi': 0.005100558772071917, 'xi': -0.8729095346039718}, {'wi': 0.005195685250901697, 'xi': -0.8677613657021737}, {'wi': 0.005290243858762931, 'xi': -0.8625183533931814}, {'wi': 0.005384224260718625, 'xi': -0.8571810707206515}, {'wi': 0.00547761618502216, 'xi': -0.8517501010316768}, {'wi': 0.005570409424250912, 'xi': -0.846226037913026}, {'wi': 0.0056625938364141, 'xi': -0.8406094851262689}, {'wi': 0.005754159346065925, 'xi': -0.8349010565417856}, {'wi': 0.005845095945399665, 'xi': -0.8291013760716741}, {'wi': 0.00593539369535159, 'xi': -0.8232110776015571}, {'wi': 0.006025042726679189, 'xi': -0.8172308049213011}, {'wi': 0.00611403324104516, 'xi': -0.8111612116546523}, {'wi': 0.006202355512083538, 'xi': -0.8050029611877982}, {'wi': 0.006289999886466073, 'xi': -0.7987567265968609}, {'wi': 0.006376956784955724, 'xi': -0.7924231905743324}, {'wi': 0.006463216703457089, 'xi': -0.7860030453544584}, {'wi': 0.006548770214047758, 'xi': -0.7794969926375801}, {'wi': 0.006633607966017278, 'xi': -0.7729057435134394}, {'wi': 0.006717720686882958, 'xi': -0.7662300183834609}, {'wi': 0.006801099183406562, 'xi': -0.7594705468820128}, {'wi': 0.006883734342598629, 'xi': -0.752628067796661}, {'wi': 0.006965617132712323, 'xi': -0.7457033289874226}, {'wi': 0.007046738604232942, 'xi': -0.7386970873050263}, {'wi': 0.007127089890856925, 'xi': -0.7316101085081913}, {'wi': 0.00720666221045721, 'xi': -0.7244431671799336}, {'wi': 0.007285446866045575, 'xi': -0.7171970466429053}, {'wi': 0.007363435246723667, 'xi': -0.7098725388737805}, {'wi': 0.007440618828623165, 'xi': -0.7024704444166952}, {'wi': 0.007516989175838127, 'xi': -0.6949915722957499}, {'wi': 0.00759253794134381, 'xi': -0.687436739926587}, {'wi': 0.00766725686791544, 'xi': -0.6798067730270485}, {'wi': 0.007741137789022853, 'xi': -0.6721025055269295}, {'wi': 0.007814172629730618, 'xi': -0.664324779476831}, {'wi': 0.007886353407574867, 'xi': -0.6564744449561274}, {'wi': 0.007957672233438696, 'xi': -0.6485523599800557}, {'wi': 0.008028121312413431, 'xi': -0.6405593904059368}, {'wi': 0.008097692944651399, 'xi': -0.6324964098385406}, {'wi': 0.008166379526206328, 'xi': -0.6243642995346039}, {'wi': 0.008234173549864516, 'xi': -0.6161639483065119}, {'wi': 0.008301067605967511, 'xi': -0.6078962524251537}, {'wi': 0.008367054383218171, 'xi': -0.5995621155219635}, {'wi': 0.008432126669484258, 'xi': -0.5911624484901564}, {'wi': 0.008496277352582184, 'xi': -0.5826981693851707}, {'wi': 0.00855949942105777, 'xi': -0.5741702033243277}, {'wi': 0.0086217859649508, 'xi': -0.5655794823857192}, {'wi': 0.008683130176550834, 'xi': -0.5569269455063353}, {'wi': 0.008743525351141115, 'xi': -0.5482135383794405}, {'wi': 0.008802964887732032, 'xi': -0.5394402133512137}, {'wi': 0.008861442289781389, 'xi': -0.530607929316659}, {'wi': 0.008918951165904982, 'xi': -0.5217176516148028}, {'wi': 0.008975485230575515, 'xi': -0.5127703519231845}, {'wi': 0.009031038304809573, 'xi': -0.5037670081516558}, {'wi': 0.00908560431684233, 'xi': -0.4947086043354983}, {'wi': 0.009139177302791382, 'xi': -0.4855961305278722}, {'wi': 0.009191751407309282, 'xi': -0.4764305826916062}, {'wi': 0.009243320884222538, 'xi': -0.46721296259034245}, {'wi': 0.009293880097160529, 'xi': -0.4579442776790469}, {'wi': 0.009343423520170346, 'xi': -0.4486255409938982}, {'wi': 0.009391945738322638, 'xi': -0.4392577710415656}, {'wi': 0.009439441448301071, 'xi': -0.42984199168789106}, {'wi': 0.009485905458984244, 'xi': -0.4203792320459818}, {'wi': 0.009531332692011365, 'xi': -0.410870526363734}, {'wi': 0.009575718182338195, 'xi': -0.4013169139107916}, {'wi': 0.009619057078779341, 'xi': -0.39171943886495786}, {'wi': 0.009661344644539192, 'xi': -0.3820791501980705}, {'wi': 0.009702576257728315, 'xi': -0.37239710156135264}, {'wi': 0.009742747411869496, 'xi': -0.3626743511702518}, {'wi': 0.009781853716390513, 'xi': -0.3529119616887808}, {'wi': 0.009819890897103521, 'xi': -0.34311100011337214}, {'wi': 0.009856854796672051, 'xi': -0.3332725376562591}, {'wi': 0.009892741375065921, 'xi': -0.3233976496283951}, {'wi': 0.009927546710002505, 'xi': -0.3134874153219265}, {'wi': 0.009961266997374927, 'xi': -0.30354291789222987}, {'wi': 0.009993898551669671, 'xi': -0.2935652442395252}, {'wi': 0.01002543780636664, 'xi': -0.2835554848900834}, {'wi': 0.01005588131433126, 'xi': -0.27351473387703407}, {'wi': 0.010085225748190218, 'xi': -0.2634440886207915}, {'wi': 0.010113467900695193, 'xi': -0.25334464980911087}, {'wi': 0.010140604685073891, 'xi': -0.2432175212767861}, {'wi': 0.010166633135366544, 'xi': -0.23306380988500494}, {'wi': 0.010191550406750693, 'xi': -0.22288462540037268}, {'wi': 0.010215353775852488, 'xi': -0.21268108037361771}, {'wi': 0.010238040641043254, 'xi': -0.20245429001799448}, {'wi': 0.010259608522724823, 'xi': -0.19220537208739366}, {'wi': 0.010280055063600031, 'xi': -0.18193544675417586}, {'wi': 0.010299378028930526, 'xi': -0.1716456364867402}, {'wi': 0.010317575306780851, 'xi': -0.16133706592684252}, {'wi': 0.010334644908249762, 'xi': -0.15101086176667572}, {'wi': 0.010350584967686864, 'xi': -0.14066815262572602}, {'wi': 0.010365393742897355, 'xi': -0.1303100689274186}, {'wi': 0.0103790696153316, 'xi': -0.11993774277556635}, {'wi': 0.010391611090262601, 'xi': -0.10955230783063472}, {'wi': 0.010403016796949308, 'xi': -0.09915489918583581}, {'wi': 0.010413285488786112, 'xi': -0.08874665324306741}, {'wi': 0.010422416043439481, 'xi': -0.07832870758870744}, {'wi': 0.010430407462970422, 'xi': -0.06790220086927987}, {'wi': 0.010437258873943533, 'xi': -0.057468272667004314}, {'wi': 0.010442969527522635, 'xi': -0.0470280633752434}, {'wi': 0.010447538799552401, 'xi': -0.03658271407386214}, {'wi': 0.010450966190626718, 'xi': -0.02613336640451098}, {'wi': 0.010453251326143272, 'xi': -0.015681162445849016}, {'wi': 0.010454393956344328, 'xi': -0.005227244588717761}, {'wi': 0.010454393956344328, 'xi': 0.005227244588717761}, {'wi': 0.010453251326143272, 'xi': 0.015681162445849016}, {'wi': 0.010450966190626718, 'xi': 0.02613336640451098}, {'wi': 0.010447538799552401, 'xi': 0.03658271407386214}, {'wi': 0.010442969527522635, 'xi': 0.0470280633752434}, {'wi': 0.010437258873943533, 'xi': 0.057468272667004314}, {'wi': 0.010430407462970422, 'xi': 0.06790220086927987}, {'wi': 0.010422416043439481, 'xi': 0.07832870758870744}, {'wi': 0.010413285488786112, 'xi': 0.08874665324306741}, {'wi': 0.010403016796949308, 'xi': 0.09915489918583581}, {'wi': 0.010391611090262601, 'xi': 0.10955230783063472}, {'wi': 0.0103790696153316, 'xi': 0.11993774277556635}, {'wi': 0.010365393742897355, 'xi': 0.1303100689274186}, {'wi': 0.010350584967686864, 'xi': 0.14066815262572602}, {'wi': 0.010334644908249762, 'xi': 0.15101086176667572}, {'wi': 0.010317575306780851, 'xi': 0.16133706592684252}, {'wi': 0.010299378028930526, 'xi': 0.1716456364867402}, {'wi': 0.010280055063600031, 'xi': 0.18193544675417586}, {'wi': 0.010259608522724823, 'xi': 0.19220537208739366}, {'wi': 0.010238040641043254, 'xi': 0.20245429001799448}, {'wi': 0.010215353775852488, 'xi': 0.21268108037361771}, {'wi': 0.010191550406750693, 'xi': 0.22288462540037268}, {'wi': 0.010166633135366544, 'xi': 0.23306380988500494}, {'wi': 0.010140604685073891, 'xi': 0.2432175212767861}, {'wi': 0.010113467900695193, 'xi': 0.25334464980911087}, {'wi': 0.010085225748190218, 'xi': 0.2634440886207915}, {'wi': 0.01005588131433126, 'xi': 0.27351473387703407}, {'wi': 0.01002543780636664, 'xi': 0.2835554848900834}, {'wi': 0.009993898551669671, 'xi': 0.2935652442395252}, {'wi': 0.009961266997374927, 'xi': 0.30354291789222987}, {'wi': 0.009927546710002505, 'xi': 0.3134874153219265}, {'wi': 0.009892741375065921, 'xi': 0.3233976496283951}, {'wi': 0.009856854796672051, 'xi': 0.3332725376562591}, {'wi': 0.009819890897103521, 'xi': 0.34311100011337214}, {'wi': 0.009781853716390513, 'xi': 0.3529119616887808}, {'wi': 0.009742747411869496, 'xi': 0.3626743511702518}, {'wi': 0.009702576257728315, 'xi': 0.37239710156135264}, {'wi': 0.009661344644539192, 'xi': 0.3820791501980705}, {'wi': 0.009619057078779341, 'xi': 0.39171943886495786}, {'wi': 0.009575718182338195, 'xi': 0.4013169139107916}, {'wi': 0.009531332692011365, 'xi': 0.410870526363734}, {'wi': 0.009485905458984244, 'xi': 0.4203792320459818}, {'wi': 0.009439441448301071, 'xi': 0.42984199168789106}, {'wi': 0.009391945738322638, 'xi': 0.4392577710415656}, {'wi': 0.009343423520170346, 'xi': 0.4486255409938982}, {'wi': 0.009293880097160529, 'xi': 0.4579442776790469}, {'wi': 0.009243320884222538, 'xi': 0.46721296259034245}, {'wi': 0.009191751407309282, 'xi': 0.4764305826916062}, {'wi': 0.009139177302791382, 'xi': 0.4855961305278722}, {'wi': 0.00908560431684233, 'xi': 0.4947086043354983}, {'wi': 0.009031038304809573, 'xi': 0.5037670081516558}, {'wi': 0.008975485230575515, 'xi': 0.5127703519231845}, {'wi': 0.008918951165904982, 'xi': 0.5217176516148028}, {'wi': 0.008861442289781389, 'xi': 0.530607929316659}, {'wi': 0.008802964887732032, 'xi': 0.5394402133512137}, {'wi': 0.008743525351141115, 'xi': 0.5482135383794405}, {'wi': 0.008683130176550834, 'xi': 0.5569269455063353}, {'wi': 0.0086217859649508, 'xi': 0.5655794823857192}, {'wi': 0.00855949942105777, 'xi': 0.5741702033243277}, {'wi': 0.008496277352582184, 'xi': 0.5826981693851707}, {'wi': 0.008432126669484258, 'xi': 0.5911624484901564}, {'wi': 0.008367054383218171, 'xi': 0.5995621155219635}, {'wi': 0.008301067605967511, 'xi': 0.6078962524251537}, {'wi': 0.008234173549864516, 'xi': 0.6161639483065119}, {'wi': 0.008166379526206328, 'xi': 0.6243642995346039}, {'wi': 0.008097692944651399, 'xi': 0.6324964098385406}, {'wi': 0.008028121312413431, 'xi': 0.6405593904059368}, {'wi': 0.007957672233438696, 'xi': 0.6485523599800557}, {'wi': 0.007886353407574867, 'xi': 0.6564744449561274}, {'wi': 0.007814172629730618, 'xi': 0.664324779476831}, {'wi': 0.007741137789022853, 'xi': 0.6721025055269295}, {'wi': 0.00766725686791544, 'xi': 0.6798067730270485}, {'wi': 0.00759253794134381, 'xi': 0.687436739926587}, {'wi': 0.007516989175838127, 'xi': 0.6949915722957499}, {'wi': 0.007440618828623165, 'xi': 0.7024704444166952}, {'wi': 0.007363435246723667, 'xi': 0.7098725388737805}, {'wi': 0.007285446866045575, 'xi': 0.7171970466429053}, {'wi': 0.00720666221045721, 'xi': 0.7244431671799336}, {'wi': 0.007127089890856925, 'xi': 0.7316101085081913}, {'wi': 0.007046738604232942, 'xi': 0.7386970873050263}, {'wi': 0.006965617132712323, 'xi': 0.7457033289874226}, {'wi': 0.006883734342598629, 'xi': 0.752628067796661}, {'wi': 0.006801099183406562, 'xi': 0.7594705468820128}, {'wi': 0.006717720686882958, 'xi': 0.7662300183834609}, {'wi': 0.006633607966017278, 'xi': 0.7729057435134394}, {'wi': 0.006548770214047758, 'xi': 0.7794969926375801}, {'wi': 0.006463216703457089, 'xi': 0.7860030453544584}, {'wi': 0.006376956784955724, 'xi': 0.7924231905743324}, {'wi': 0.006289999886466073, 'xi': 0.7987567265968609}, {'wi': 0.006202355512083538, 'xi': 0.8050029611877982}, {'wi': 0.00611403324104516, 'xi': 0.8111612116546523}, {'wi': 0.006025042726679189, 'xi': 0.8172308049213011}, {'wi': 0.00593539369535159, 'xi': 0.8232110776015571}, {'wi': 0.005845095945399665, 'xi': 0.8291013760716741}, {'wi': 0.005754159346065925, 'xi': 0.8349010565417856}, {'wi': 0.0056625938364141, 'xi': 0.8406094851262689}, {'wi': 0.005570409424250912, 'xi': 0.846226037913026}, {'wi': 0.00547761618502216, 'xi': 0.8517501010316768}, {'wi': 0.005384224260718625, 'xi': 0.8571810707206515}, {'wi': 0.005290243858762931, 'xi': 0.8625183533931814}, {'wi': 0.005195685250901697, 'xi': 0.8677613657021737}, {'wi': 0.005100558772071917, 'xi': 0.8729095346039718}, {'wi': 0.005004874819279619, 'xi': 0.8779622974209857}, {'wi': 0.004908643850461776, 'xi': 0.8829191019031915}, {'wi': 0.004811876383340633, 'xi': 0.88777940628849}, {'wi': 0.00471458299427761, 'xi': 0.8925426793619202}, {'wi': 0.0046167743171150275, 'xi': 0.8972084005137191}, {'wi': 0.0045184610420126335, 'xi': 0.9017760597962232}, {'wi': 0.004419653914284973, 'xi': 0.9062451579796031}, {'wi': 0.00432036373322198, 'xi': 0.9106152066064295}, {'wi': 0.004220601350909151, 'xi': 0.9148857280450583}, {'wi': 0.004120377671042705, 'xi': 0.9190562555418367}, {'wi': 0.004019703647735912, 'xi': 0.9231263332721162}, {'wi': 0.003918590284326866, 'xi': 0.927095516390074}, {'wi': 0.0038170486321701296, 'xi': 0.9309633710773335}, {'wi': 0.0037150897894308427, 'xi': 0.93472947459038}, {'wi': 0.003612724899876582, 'xi': 0.9383934153067655}, {'wi': 0.0035099651516519244, 'xi': 0.9419547927700982}, {'wi': 0.0034068217760577103, 'xi': 0.9454132177338137}, {'wi': 0.0033033060463318717, 'xi': 0.9487683122037179}, {'wi': 0.0031994292764025785, 'xi': 0.952019709479303}, {'wi': 0.0030952028196665126, 'xi': 0.9551670541938289}, {'wi': 0.0029906380677446804, 'xi': 0.9582100023531646}, {'wi': 0.0028857464492318416, 'xi': 0.9611482213733913}, {'wi': 0.0027805394284531617, 'xi': 0.9639813901171552}, {'wi': 0.0026750285042124664, 'xi': 0.9667091989287728}, {'wi': 0.002569225208541661, 'xi': 0.9693313496680812}, {'wi': 0.002463141105431511, 'xi': 0.9718475557430343}, {'wi': 0.0023567877895827394, 'xi': 0.9742575421410374}, {'wi': 0.0022501768851388364, 'xi': 0.9765610454590226}, {'wi': 0.002143320044422011, 'xi': 0.9787578139322586}, {'wi': 0.0020362289466651345, 'xi': 0.9808476074619004}, {'wi': 0.0019289152967671226, 'xi': 0.9828301976412724}, {'wi': 0.0018213908240185465, 'xi': 0.9847053677808957}, {'wi': 0.001713667280856934, 'xi': 0.9864729129322606}, {'wi': 0.0016057564416436195, 'xi': 0.9881326399103605}, {'wi': 0.0014976701014651013, 'xi': 0.9896843673150097}, {'wi': 0.0013894200749902227, 'xi': 0.9911279255509899}, {'wi': 0.0012810181954302762, 'xi': 0.9924631568471006}, {'wi': 0.0011724763137037884, 'xi': 0.9936899152742682}, {'wi': 0.0010638062980444988, 'xi': 0.9948080667630034}, {'wi': 0.0009550200344351948, 'xi': 0.9958174891208242}, {'wi': 0.0008461294290767029, 'xi': 0.9967180720510002}, {'wi': 0.0007371464159049647, 'xi': 0.9975097171758793}, {'wi': 0.0006280829779749172, 'xi': 0.9981923380734435}, {'wi': 0.0005189512134561268, 'xi': 0.998765860353095}, {'wi': 0.0004097635734026843, 'xi': 0.9992302218632736}, {'wi': 0.0003005339654054824, 'xi': 0.9995853734488864}, {'wi': 0.00019128554465451525, 'xi': 0.9998312829844194}, {'wi': 8.217779367852784e-05, 'xi': 0.9999679782184367}]

const NumCalc = {

  maximum: (f, a, b, error) => {
    error = error == undefined ? 1e-4 : error
    let c = b - (b - a) / NumCalc_GR
    let d = a + (b - a) / NumCalc_GR
    while (Math.abs(b - a) > error) {
      if (f(c) > f(d)) {
        b = d
      }
      else {
        a = c
      }
      c = b - (b - a) / NumCalc_GR
      d = a + (b - a) / NumCalc_GR
    }
    return (a + b) / 2
  },

  minimum: (f, a, b, error) => {
    error = error == undefined ? 1e-4 : error
    let c = b - (b - a) / NumCalc_GR
    let d = a + (b - a) / NumCalc_GR
    while (Math.abs(b - a) > error) {
      if (f(c) < f(d)) {
        b = d
      }
      else {
        a = c
      }
      c = b - (b - a) / NumCalc_GR
      d = a + (b - a) / NumCalc_GR
    }
    return (a + b) / 2
  },

  nCr: (n, k) => {
    var result = 1;
    for (var i = 1; i <= k; i++) {
      result *= (n + 1 - i) / i;
    }
    return result;
  },
  Legendre: (x, n) => {
    n = n == undefined ? 1 : n
    let sum = 0
    for (let k=0;k<=n;k++){
      sum += x**k * NumCalc.nCr(n, k) * NumCalc.nCr(2*n-2*k, n) * x**(n-2*k)
    }
    return 2**n * sum
  },
  NDerivative: (f, x, n) => {
    n = n == undefined ? 1 : n
    let h = NumCalc_ROOT_EPSILON * (Math.abs(x) + NumCalc_ROOT_EPSILON) * n ** 2
    let sum = 0
    for (let k = 0; k <= n; k++) {
      sum += (-1) ** k * NumCalc.nCr(n, k) * f(x + (n - 2 * k) * h)
    }
    return 1 / ((2 * h) ** n) * sum
  },

  FDerivative: (f, n) => {
    n = n == undefined ? 1 : n
    return (x) => { return NumCalc.NDerivative(f, x, n); };
  },

  NIntegrate: (f, a, b, prec) => {
    let lower = a
    let upper = b
    let integrand;

    if (a == b){
      return 0
    }
    if (b == Number.NEGATIVE_INFINITY || a == Number.POSITIVE_INFINITY) {
      return -NumCalc.NIntegrate(f, b, a)
    }
    if (b < a) {
      integrand = function(x) {
        return -f(x)
      }
      lower = b
      upper = a
    }
    else if (b == Number.POSITIVE_INFINITY && isFinite(a)) {
      integrand = function(x) {
        if (x == 1) {
          x -= 0.000001 //1/0 error prevention
        }
        return f(a + x / (1 - x)) / ((1 - x) ** 2)
      }
      lower = 0
      upper = 1
    }
    else if (a == Number.NEGATIVE_INFINITY && isFinite(b)) {
      integrand = function(x) {
        if (x == 0) {
          x += 0.000001 //1/0 error prevention
        }
        return f(b - (1 - x) / x) / x ** 2
      }
      lower = 0
      upper = 1
    }
    else if (a == Number.NEGATIVE_INFINITY && b == Number.POSITIVE_INFINITY) {
      integrand = function(x) {
        if (x == 1) {
          x -= 0.000001 //1/0 error prevention
        }
        if (x == -1) {
          x += 0.000001 //1/0 error prevention
        }
        return f(x / (1 - x ** 2)) * ((1 + x ** 2) / ((1 - x ** 2) ** 2))
      }
      lower = -1
      upper = 1
    }
    else {
      integrand = function(x) {
        return f((b-a)/2 * x + (a+b)/2) * (b-a)/2
      }
    }
    let sum = 0
    if (prec != undefined && prec == true){
      for (let i=0;i<NumCalc_Gaussian_Wi_xi_300.length;i++){
        sum += NumCalc_Gaussian_Wi_xi_300[i].wi * integrand(NumCalc_Gaussian_Wi_xi_300[i].xi)
      }
      return sum
    }
    for (let i=0;i<NumCalc_Gaussian_Wi_xi_64.length;i++){
      sum += NumCalc_Gaussian_Wi_xi_64[i].wi * integrand(NumCalc_Gaussian_Wi_xi_64[i].xi)
    }
    return sum
  }

}